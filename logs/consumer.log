2025-06-07 19:20:20,429 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-06-07 19:20:20,439 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Broker version identified as 2.6
2025-06-07 19:20:20,439 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-06-07 19:20:20,439 - kafka.consumer.subscription_state - INFO - Updating subscribed topics to: ('covid-data',)
2025-06-07 19:20:20,440 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-06-07 19:20:20,442 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Broker version identified as 2.6
2025-06-07 19:20:20,443 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-06-07 19:20:20,446 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-06-07 19:20:20,550 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-06-07 19:20:20,551 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-06-07 19:20:20,659 - kafka.cluster - INFO - Coordinator for group/tweet-transformer-group is BrokerMetadata(nodeId='coordinator-1', host='localhost', port=9092, rack=None)
2025-06-07 19:20:20,659 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group tweet-transformer-group
2025-06-07 19:20:20,660 - kafka.coordinator.heartbeat - INFO - Starting new heartbeat thread
2025-06-07 19:20:20,660 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group tweet-transformer-group
2025-06-07 19:20:20,660 - kafka.coordinator - INFO - Failed to join group tweet-transformer-group: NodeNotReadyError: coordinator-1
2025-06-07 19:20:20,661 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=coordinator-1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-06-07 19:20:20,762 - kafka.coordinator - INFO - Failed to join group tweet-transformer-group: NodeNotReadyError: coordinator-1
2025-06-07 19:20:20,763 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.2.11, node_id=coordinator-1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-06-07 19:20:20,868 - kafka.coordinator - INFO - (Re-)joining group tweet-transformer-group
2025-06-07 19:20:20,873 - kafka.coordinator - INFO - Received member id kafka-python-2.2.11-02d849c1-6897-4d0c-a5e3-17b66f32653f for group tweet-transformer-group; will retry join-group
2025-06-07 19:20:20,874 - kafka.coordinator - INFO - Failed to join group tweet-transformer-group: [Error 79] MemberIdRequiredError
2025-06-07 19:20:20,874 - kafka.coordinator - INFO - (Re-)joining group tweet-transformer-group
2025-06-07 19:20:23,879 - kafka.coordinator - INFO - Successfully joined group tweet-transformer-group <Generation 12 (member_id: kafka-python-2.2.11-02d849c1-6897-4d0c-a5e3-17b66f32653f, protocol: range)>
2025-06-07 19:20:23,879 - kafka.coordinator - INFO - Elected group leader -- performing partition assignments using range
2025-06-07 19:20:23,882 - kafka.consumer.subscription_state - INFO - Updated partition assignment: [TopicPartition(topic='covid-data', partition=0)]
2025-06-07 19:20:23,882 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions {TopicPartition(topic='covid-data', partition=0)} for group tweet-transformer-group
2025-06-07 19:20:43,721 - kafka.coordinator.heartbeat - INFO - Stopping heartbeat thread
2025-06-07 19:20:46,727 - kafka.coordinator.heartbeat - WARNING - Heartbeat thread did not fully terminate during close
2025-06-07 19:20:46,728 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
INFO: <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
INFO: <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Broker version identified as 2.6
INFO: <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
WARNING: group_id is None: disabling auto-commit.
INFO: Updating subscribed topics to: ('covid-data',)
INFO: <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
INFO: <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Broker version identified as 2.6
INFO: <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
INFO: Updated partition assignment: [TopicPartition(topic='covid-data', partition=0)]
INFO: <BrokerConnection client_id=kafka-python-2.2.11, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
INFO: <BrokerConnection client_id=kafka-python-2.2.11, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
INFO: <BrokerConnection client_id=kafka-python-2.2.11, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
INFO: Resetting offset for partition TopicPartition(topic='covid-data', partition=0) to offset 660.
INFO: <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-06-07 19:44:56,876 - INFO - âœ… spaCy model loaded successfully
2025-06-07 19:44:56,886 - INFO - âœ… Geolocator initialized
2025-06-07 19:47:21,390 - TweetConsumer - INFO - Starting Kafka Consumer Service
2025-06-07 19:47:24,903 - TweetConsumer - INFO - Processing record from Terra Vetter (ID: ?)
2025-06-07 19:47:25,479 - TweetConsumer - WARNING - Attempt 1/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:27,480 - TweetConsumer - WARNING - Attempt 2/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:31,482 - TweetConsumer - WARNING - Attempt 3/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:31,483 - TweetConsumer - ERROR - Failed to process record from Terra Vetter: name 'send_to_kafka' is not defined
2025-06-07 19:47:31,483 - TweetConsumer - INFO - Processing record from Melisa Oporto (Hey, wear a mask ðŸ˜·) (ID: ?)
2025-06-07 19:47:32,084 - TweetConsumer - WARNING - Attempt 1/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:34,087 - TweetConsumer - WARNING - Attempt 2/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:38,093 - TweetConsumer - WARNING - Attempt 3/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:38,094 - TweetConsumer - ERROR - Failed to process record from Melisa Oporto (Hey, wear a mask ðŸ˜·): name 'send_to_kafka' is not defined
2025-06-07 19:47:38,094 - TweetConsumer - INFO - Processing record from Nicole DeAngelis (ID: ?)
2025-06-07 19:47:38,099 - TweetConsumer - WARNING - Transformation returned empty result
2025-06-07 19:47:38,099 - TweetConsumer - ERROR - Transformation error: name 'save_unprocessed_record' is not defined
2025-06-07 19:47:38,099 - TweetConsumer - ERROR - Failed to process record from Nicole DeAngelis: name 'save_failed_record' is not defined
2025-06-07 19:47:38,099 - TweetConsumer - INFO - Processing record from athamiddi (ID: ?)
2025-06-07 19:47:38,122 - TweetConsumer - WARNING - Attempt 1/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:40,127 - TweetConsumer - WARNING - Attempt 2/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:44,128 - TweetConsumer - WARNING - Attempt 3/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:44,128 - TweetConsumer - ERROR - Failed to process record from athamiddi: name 'send_to_kafka' is not defined
2025-06-07 19:47:44,128 - TweetConsumer - INFO - Processing record from The Gritty Nurse- #paidsickdays is a must (ID: ?)
2025-06-07 19:47:44,160 - TweetConsumer - WARNING - Attempt 1/3 failed for Kafka submission: name 'send_to_kafka' is not defined
2025-06-07 19:47:44,916 - TweetConsumer - INFO - Service stopped by user
